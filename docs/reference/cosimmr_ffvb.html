<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Run a cosimmr_input object through the Fixed Form Variational Bayes(FFVB) function — cosimmr_ffvb • cosimmr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Run a cosimmr_input object through the Fixed Form Variational Bayes(FFVB) function — cosimmr_ffvb"><meta property="og:description" content="This is the main function of cosimmr. It takes a cosimmr_input object
created via cosimmr_load, runs it in fixed form
Variational Bayes to determine the dietary proportions, and then
outputs a cosimmr_output object for further analysis and plotting
via plot.cosimmr_output."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cosimmr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/cosimmr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run a <code>cosimmr_input</code> object through the Fixed Form Variational Bayes(FFVB) function</h1>
    
    <div class="hidden name"><code>cosimmr_ffvb.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is the main function of cosimmr. It takes a <code>cosimmr_input</code> object
created via <code><a href="cosimmr_load.html">cosimmr_load</a></code>, runs it in fixed form
Variational Bayes to determine the dietary proportions, and then
outputs a <code>cosimmr_output</code> object for further analysis and plotting
via <code><a href="plot.cosimmr_output.html">plot.cosimmr_output</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cosimmr_ffvb</span><span class="op">(</span></span>
<span>  <span class="va">cosimmr_in</span>,</span>
<span>  prior_control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu_0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">(</span><span class="va">cosimmr_in</span><span class="op">$</span><span class="va">n_sources</span> <span class="op">*</span> <span class="va">cosimmr_in</span><span class="op">$</span><span class="va">n_covariates</span> <span class="op">+</span></span>
<span>    <span class="va">cosimmr_in</span><span class="op">$</span><span class="va">n_tracers</span><span class="op">)</span><span class="op">)</span>, sigma_0 <span class="op">=</span> <span class="fl">1</span>, tau_shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">cosimmr_in</span><span class="op">$</span><span class="va">n_tracers</span><span class="op">)</span>,</span>
<span>    tau_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">cosimmr_in</span><span class="op">$</span><span class="va">n_tracers</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ffvb_control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_output <span class="op">=</span> <span class="fl">3600</span>, S <span class="op">=</span> <span class="fl">500</span>, P <span class="op">=</span> <span class="fl">100</span>, beta_1 <span class="op">=</span> <span class="fl">0.75</span>, beta_2 <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>    tau <span class="op">=</span> <span class="fl">500</span>, eps_0 <span class="op">=</span> <span class="fl">0.001</span>, t_W <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>cosimmr_in</dt>
<dd><p>An object created via the function <code><a href="cosimmr_load.html">cosimmr_load</a></code></p></dd>


<dt>prior_control</dt>
<dd><p>A list of values including arguments named <code>mu_0</code>
(prior for mu), and <code>sigma_0</code> (prior for sigma).</p></dd>


<dt>ffvb_control</dt>
<dd><p>A list of values including arguments named <code>n_output</code>
(number of rows in theta output), <code>S</code> (number of samples taken at each
iteration of the algorithm), <code>P</code> (patience parameter), <code>beta_1</code>
and <code>beta_2</code> (adaptive learning weights), <code>tau</code> (threshold for
exploring learning space), <code>eps_0</code> (fixed learning rate),
<code>t_W</code> (rolling window size)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>cosimmr_output</code> with two named top-level
components:</p>
<dl><dt>input </dt>
<dd><p>The <code>cosimmr_input</code> object given to the
<code>cosimmr_ffvb</code> function</p></dd>
 <dt>output </dt>
<dd><p>A set of outputs produced by
the FFVB function. These can be analysed using the
<code><a href="summary.cosimmr_output.html">summary.cosimmr_output</a></code> and <code><a href="plot.cosimmr_output.html">plot.cosimmr_output</a></code>
functions.</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Andrew C. Parnell, Donald L. Phillips, Stuart Bearhop, Brice X.
Semmens, Eric J. Ward, Jonathan W. Moore, Andrew L. Jackson, Jonathan Grey,
David J. Kelly, and Richard Inger. Bayesian stable isotope mixing models.
Environmetrics, 24(6):387–399, 2013.</p>
<p>Andrew C Parnell, Richard Inger, Stuart Bearhop, and Andrew L Jackson.
Source partitioning using stable isotopes: coping with too much variation.
PLoS ONE, 5(3):5, 2010.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="cosimmr_load.html">cosimmr_load</a></code> for creating objects suitable for this
function, <code><a href="plot.cosimmr_input.html">plot.cosimmr_input</a></code> for creating isospace plots,
<code><a href="summary.cosimmr_output.html">summary.cosimmr_output</a></code> for summarising output, and
<code><a href="plot.cosimmr_output.html">plot.cosimmr_output</a></code> for plotting output.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Emma Govan &lt;emmagovan@gmail.com&gt;, Andrew Parnell</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">## See the package vignette for a detailed run through of these examples</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Data set 1: 10 obs on 2 isos, 4 sources, with tefs and concdep</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">geese_data_day1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cosimmr_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">geese_data_day1</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="cosimmr_load.html">cosimmr_load</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">mixtures</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    source_names <span class="op">=</span> <span class="va">source_names</span>,</span></span>
<span class="r-in"><span>    source_means <span class="op">=</span> <span class="va">source_means</span>,</span></span>
<span class="r-in"><span>    source_sds <span class="op">=</span> <span class="va">source_sds</span>,</span></span>
<span class="r-in"><span>    correction_means <span class="op">=</span> <span class="va">correction_means</span>,</span></span>
<span class="r-in"><span>    correction_sds <span class="op">=</span> <span class="va">correction_sds</span>,</span></span>
<span class="r-in"><span>    concentration_means <span class="op">=</span> <span class="va">concentration_means</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cosimmr_1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Print</span></span></span>
<span class="r-in"><span><span class="va">cosimmr_1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># FFVB run</span></span></span>
<span class="r-in"><span><span class="va">cosimmr_1_out</span> <span class="op">&lt;-</span> <span class="fu">cosimmr_ffvb</span><span class="op">(</span><span class="va">cosimmr_1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Print it</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cosimmr_1_out</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Summary</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cosimmr_1_out</span>, type <span class="op">=</span> <span class="st">"correlations"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cosimmr_1_out</span>, type <span class="op">=</span> <span class="st">"statistics"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cosimmr_1_out</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"quantiles"</span>, <span class="st">"statistics"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cosimmr_1_out</span>, type <span class="op">=</span> <span class="st">"beta_boxplot"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cosimmr_1_out</span>, type <span class="op">=</span> <span class="st">"beta_histogram"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare two sources</span></span></span>
<span class="r-in"><span><span class="fu">compare_sources</span><span class="op">(</span><span class="va">cosimmr_1_out</span>, source_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Zostera"</span>, <span class="st">"Enteromorpha"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare multiple sources</span></span></span>
<span class="r-in"><span><span class="fu">compare_sources</span><span class="op">(</span><span class="va">cosimmr_1_out</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Emma Govan, Andrew Parnell.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

